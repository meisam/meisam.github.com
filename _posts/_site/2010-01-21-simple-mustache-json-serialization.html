<p>If you&#8217;ve taken a look at <a href="http://github.com/defunkt/mustache">Mustache</a>, the &#8220;stupid in a good way&#8221; templating engine, you might know that there are also Javascript Mustache renderers such as <a href="http://github.com/janl/mustache.js">Mustache.js</a>. Today I&#8217;ve released a small library called <a href="http://github.com/intridea/mustache_json">mustache_json</a> that allows you to compile your Mustache view objects into <span class="caps">JSON</span>, allowing them to be interpreted by Javascript Mustache rendering engines.</p>
<p>What this means for your project is that you will finally have a identical client-side and server-side rendering interface, opening wide the opportunities for pushing more of the rendering work onto the client-side, a boon for many real-time and heavy-interaction applications.</p>
<p>To install <code>mustache_json</code>, just get the gem from Gemcutter:</p>
<pre><code>gem install mustache_json</code></pre>
<p>To use it, simply <code>require 'mustache_json'</code> and all of your Mustache objects will automatically be given a <code>#to_json</code> method. For instance:</p>
<div>
<pre>
<code class='ruby'>require 'mustache_json'
<p>class Person &lt; Mustache<br />
  def initialize(first_name, last_name)<br />
    context[:first_name], context[:last_name] = first_name, last_name<br />
  end</p>
def initials
&quot;#{context[:first_name][0..0]}.#{context[:last_name][0..0]}.&quot;
end

def listing
&quot;#{context[:last_name]}, #{context[:first_name]}&quot;
end
<p>end</p>
<p>bob = Person.new(&#8216;Bob&#8217;, &#8216;Bobson&#8217;)<br />
bob.to_json</code><br />
  </pre></p>
</div>
<p>This will render into a <span class="caps">JSON</span> object that looks like this:</p>
<div>
<pre>
<code class='javascript'>{&amp;quot;last_name&amp;quot;:&amp;quot;Bobson&amp;quot;,&amp;quot;initials&amp;quot;:&amp;quot;B.B.&amp;quot;,&amp;quot;listing&amp;quot;:&amp;quot;Bobson, Bob&amp;quot;,&amp;quot;first_name&amp;quot;:&amp;quot;Bob&amp;quot;}</code>
</pre>
</div>
<p>Mustache <span class="caps">JSON</span> gives you access to all of the public instance methods you declare in your Mustache as well as any context you have set. It is essentially a fully compiled version of the Mustache view, providing everything another renderer needs to create the actual markup. The <span class="caps">JSON</span> back-end for this library is swappable, meaning you can use the <span class="caps">JSON</span> gem, <span class="caps">JSON</span> pure, ActiveSupport, or Yajl by default (and any other class with an <code>encode</code> method if you&#8217;ve got a different library).</p>
<p><a href="http://rdoc.info/projects/intridea/mustache_json">Documentation is available on RDoc.info</a> and the <a href="http://github.com/intridea/mustache_json">source is available on GitHub</a>. Stay tuned for posts in the future about utilizing this library to actually perform identical rendering in Ruby and Javascript.</p>